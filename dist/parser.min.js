/*!
ISON v0.0.5
(c) 2018 Rich Infante
Released under the MIT License.
*/
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function i(t,r){for(var e=0;e<r.length;e++){var i=r[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,r,e){return r&&i(t.prototype,r),e&&i(t,e),t}}();function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(t){if(Array.isArray(t)){for(var r=0,e=Array(t.length);r<t.length;r++)e[r]=t[r];return e}return Array.from(t)}!function(){var n={Date:Date,Object:Object,Array:Array,Number:Number},s={Int:parseInt,Float:parseFloat,Boolean:function(r){function t(t){return r.apply(this,arguments)}return t.toString=function(){return r.toString()},t}(function(t){return new Boolean("true"==t.toLowerCase())})};"undefined"!=typeof Map&&(n.Map=Map),"undefined"!=typeof Set&&(n.Set=Set),"undefined"!=typeof RegExp&&(n.RegExp=RegExp),"undefined"!=typeof Buffer&&("function"==typeof Buffer.from?s.Buffer=Buffer.from:n.Buffer=Buffer);var i=",",u=/[:=]/,o=/[ \n\t]/,a=/["']/,e=/[a-z0-9_]/i,h=/[a-z_]/i,f=/[+0-9\-]/,c=/[0-9xbo\.+\-a-f]/i;var r=function(){function r(t){_classCallCheck(this,r),this.cur=0,this.string=t,this.stored=""}return _createClass(r,[{key:"parseIdentifier",value:function(){this.skip(o);var t="";if(this.is(h))for(;this.is(e);)t+=this.current,this.next();else this.printError("Unexpected token character "+this.current+" ("+this.current.charCodeAt(0)+")");return t}},{key:"parseNumber",value:function(){this.skip(o);var t="";if(this.is(f))for(;this.is(c);)t+=this.current,this.next();else this.printError("Unexpected token character "+this.current+" ("+this.current.charCodeAt(0)+")");return 0==t.indexOf("0x")?parseInt(t.substr(2),16):0==t.indexOf("0b")?parseInt(t.substr(2),2):0==t.indexOf("0o")?parseInt(t.substr(2),8):parseFloat(t)}},{key:"parseString",value:function(){this.is(a)||this.printError("Invalid String start token");var t=this.current;this.skip(a,!0,1);var r="";for(t.charCodeAt(0);;){if(this.current,this.current.charCodeAt(0),this.is("\\"))r+=this.next(),this.current;else{if(this.is(t))break;r+=this.current,this.current}this.next()}return this.skip(a,!0,1),r}},{key:"parseArguments",value:function(){this.skip("(",!0,1),this.skip(o);for(var t=[];!this.is(")");){this.skip(o);var r=this.parseNext();if(t.push(r),this.skip(o),this.is(i))this.skip(i,!0,1);else{if(this.is(")"))break;this.printError('Unexpected token, "'+this.current+'" ('+this.current.charCodeAt(0)+") looking for COMMA or RBRACKET.")}}return this.skip(o),this.skip(")",!0,1),t}},{key:"parseArray",value:function(){this.skip("[",!0,1),this.skip(o);for(var t=[];!this.is("]");){this.skip(o);var r=this.parseNext();if(t.push(r),this.skip(o),this.is(i))this.skip(i,!0,1);else{if(this.is("]"))break;this.printError('Unexpected token, "'+this.current+'" ('+this.current.charCodeAt(0)+") looking for COMMA or RBRACKET.")}}return this.skip(o),this.skip("]",!0,1),t}},{key:"parseObject",value:function(){this.skip("{",!0,1),this.skip(o);for(var t={};!this.is("}");){var r=null;this.skip(o),r=this.is(a)?this.parseString():this.is(f)?this.parseNumber():this.parseIdentifier(),this.skip(o),this.skip(u,!0,1),this.skip(o);var e=this.parseNext();if(t[r]=e,this.skip(o),this.is(i))this.skip(i,!0,1);else{if(this.is("}"))break;this.printError('Unexpected token "'+this.current+'" ('+this.current.charCodeAt(0)+"), looking for COMMA or RBRACE.")}}return this.skip("}",!0,1),t}},{key:"parseNext",value:function(){if(this.skip(o),this.is("{"))return this.parseObject();if(this.is("["))return this.parseArray();if(this.is("("))return this.parseArguments();if(this.is(f))return this.parseNumber();if(this.is(a))return this.parseString();if(this.is(h)){var t=this.parseIdentifier();if(this.is("(")){var r=this.parseArguments();return e=t,i=r,debug.types("newInstance",e,i),n[e]?new(Function.prototype.bind.apply(n[e],[null].concat(_toConsumableArray(i)))):s[e]?s[e].apply(s,_toConsumableArray(i)):1==i.length?i[0]:i}return function(t){if("null"==t)return null;if("Infinity"==t)return 1/0;if("NaN"==t)return NaN;if("true"==t)return!0;if("false"==t)return!1;throw new Error("Unknown Identifier"+string)}(t)}var e,i;this.printError('Unexpected token "'+this.current+'" ('+this.current.charCodeAt(0)+")")}},{key:"is",value:function(t){var r=!1;return r=t instanceof RegExp?t.test(this.current):this.current==t,this.current,r}},{key:"printError",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Unknown Error",r=this.cur,e=r-10;e<0&&(e=0);var i=r+10;i>=this.string.length&&(i=this.string.length-1);var n=r-e;throw this.string.substring(e,i).replace(/\n/g," "),"^".padStart(n+1),this.cur,new Error(t)}},{key:"next",value:function(){return this.cur+=1,this.cur>this.string.length&&this.printError("Unexpected EOF!"),this.current}},{key:"peek",value:function(){return this.string[this.cur+1]}},{key:"clear",value:function(){this.stored=""}},{key:"getParsed",value:function(){return this.stored}},{key:"seek",value:function(t){for(;!this.currentMatches(t);)this.next(),this.current}},{key:"currentMatches",value:function(t){return t instanceof RegExp?t.test(this.current):this.current==t}},{key:"skip",value:function(t){var r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1/0;this.cur;for(r&&!this.currentMatches(t)&&this.printError('expected token "'+t+'" got "'+this.current+'"!');this.currentMatches(t)&&0<e;)this.cur+=1,e-=1;if(this.cur,t==o){if(this.current+this.peek()=="//"&&this.seek("\n"),this.current+this.peek()=="/*"){for(;this.seek("*"),this.current+this.peek()!="*/";)this.next();this.next(),this.next()}this.is(o)&&this.skip(o)}}},{key:"current",get:function(){return this.string[this.cur]}}]),r}();function p(t){return/^[a-zA-Z_][_a-zA-Z0-9]*$/.test(t)?t:l(t)}function l(t){if(t instanceof Date)return"Date("+t.getTime()+")";if("string"==typeof t||t instanceof String)return'"'+t.replace(/"/g,'\\"')+'"';if(t instanceof Array)return"["+t.map(l).join(",")+"]";if("Set"==t.constructor.name)return"Set("+l(Array.from(t))+")";if("Map"==t.constructor.name)return"Map("+l(Array.from(t.entries()))+")";if("undefined"!=typeof Buffer&&t instanceof Buffer)return"Buffer(["+[].concat(_toConsumableArray(t))+"])";if(t instanceof RegExp)return"RegExp("+l(t.source)+", "+l(t.flags)+")";if("boolean"==typeof t)return""+t;if(t instanceof Object){var r=t.$type||t.constructor.name;return delete t.$type,"Object"==r?"{"+Object.entries(t).map(function(t){return p(t[0])+":"+l(t[1])}).join(",")+"}":r+"({"+Object.entries(t).map(function(t){return p(t[0])+":"+l(t[1])}).join(",")+"})"}if(isNaN(t))return"NaN";if("number"==typeof t)return""+t;throw void 0===t||_typeof(t),new Error("Stringify Error!")}function t(t,r){var e="",i=0;r=r||"  ";for(var n=0;n<t.length;n++)if(-1<["{","[",","].indexOf(t[n])){e+=t[n]+"\n",-1<["{","["].indexOf(t[n])&&(i+=1);for(var s=0;s<i;s++)e+=r}else if(-1<["}","]"].indexOf(t[n])){i-=1,e+="\n";for(var u=0;u<i;u++)e+=r;e+=t[n]}else" "!=t[n]&&(e+=t[n]),":"==t[n]&&(e+=" ");return e}function k(t){return new r(t).parseNext()}"undefined"!=typeof module?module.exports={parse:k,stringify:l,pprint:t}:"undefined"!=typeof window&&(window.ISON={parse:k,stringify:l,pprint:t})}();
//# sourceMappingURL=parser.js.map
